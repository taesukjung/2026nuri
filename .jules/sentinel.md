## 2026-02-28 - Path Traversal (LFI) vulnerability in dynamic view routing
**Vulnerability:** The application had generic Express routes (`routes/move.js` and `routes/enMove.js`) that accepted both a directory (`dir`) and file (`file`) as path parameters to dynamically render EJS views. It passed these unsanitized variables directly into `res.render()`. While `res.render` normally targets the `views/` directory, by supplying dot-dot-slash `../` sequences, it was possible to cause path traversal outside of the `views/` folder, causing error-based information disclosure or potentially Arbitrary File Read.
**Learning:** Never pass untrusted, user-supplied input directly to `res.render()` or filesystem functions. Even if the expected use is "dynamic routing for simple HTML pages", an attacker will manipulate the inputs.
**Prevention:** Implement a strict allowlist. Create an Express middleware (e.g., `validatePath`) that checks dynamic directory parameters against a pre-approved list (`['about', 'contact', ...]`) and uses regex (`/^[a-zA-Z0-9_\-\.]+$/`) to ensure filenames contain only safe alphanumeric characters and standard extensions. Apply this middleware before any `res.render()` logic that uses dynamic path components.
